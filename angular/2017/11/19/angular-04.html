<!DOCTYPE html>
<html lang="zh-CN">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta content="telephone=no" name="format-detection" />
  <link rel="shortcut icon" type="image/x-icon" href="/assets/images/site/favicon.ico">
  <title>喵~沽酒处</title>
  <link rel="stylesheet" href="/assets/css/font-awesome.min.css">
<link rel="stylesheet" href="/assets/css/main.css">


</head>
<body>
  <div class="container">
    <header id="header">
  <div class="head-line"></div>
<progress value="0" id="head-progress" class="flat"></progress>
  <div id="head-title"><a href="/">LEONMIN</a></div>
  <div class="head-brand">
    <div id="head-back">
      <i class="fa fa-chevron-left"></i>
    </div>
    <div id="head-search">
      <div id="head-search-btn">
  <i class="fa fa-search"></i>
</div>
<div id="head-mask"></div>
<div id="head-search-contain">
  <div class="search">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <div class="search-input-wrapper">
      <input type="text" id="search-input" placeholder="Searching.." class="search-input">
    </div>
    <span class="search-close-icon">
      <i class="fa fa-times-circle-o"></i>
    </span>
  </div>
  <div class="search-result">
    <div id="results-container"></div>
  </div>
</div>
    </div>
    <div id="head-menu">
      <div class="head-menu-btn">
    <p class="drawer-hamburger-icon">
      <span></span>
      <span></span>
      <span></span>
    </p>
  </div>
<nav id="head-menu-contain">
  <h2>MENU</h2>
  <ul class="site-ham-list">
    <li>
      <a href="/">LIMI</a>
    </li>
    <li>
      <a href="/archive/">ARCHIVE</a>
    </li>
    <li>
      <a href="/tags/">TAGS</a>
    </li>
    <li>
      <a href="/about/">ABOUT</a>
    </li>
  </ul>
  <dl class="site-ham-item">
    <dt>TEL</dt>
    <dd>
      <a href="tel:097-547-9781">Tel.184-8360-0000</a>
    </dd>
    <dt>CONNECT</dt>
    <div class="aside-content">
      <span>
        <a href="http://weibo.com/leonmin" target="_blank">
          <i class="fa fa-weibo fa-3x"></i>
        </a>
      </span>
      <span>
        <a href="https://github.com/leonmin" target="_blank">
          <i class="fa fa-github fa-3x"></i>
        </a>
      </span>
      <span>
        <a href="https://twitter.com/leonminnn" target="_blank">
          <i class="fa fa-twitter fa-3x"></i>
        </a>
      </span>
      <span>
        <a href=" /feed.xml ">
          <i class="fa fa-rss fa-3x"></i>
        </a>
      </span>
    </div>
  </dl>
</nav>

    </div>
  </div>
</header>
    <main class="main">
      
<section id="posts">
    
    <article class="post">
  <header class="post-header">
    <h1 class="post-h-title">
      <a href="/angular/2017/11/19/angular-04.html">Angular-4-完善应用</a>
    </h1>
    <div class="post-meta">
        <span class="post-date">2017年11月19日</span>
        <span class="post-cate"><a href="/category/angular/" title="Angular">Angular</a></span>
      </div>
  </header>
  <section class="post-content">
    <h4 id="1-渲染多行">1. 渲染多行</h4>

<h4 id="2-创建article类">2. 创建Article类</h4>

<p>写Angular代码的最佳实践之一就是尝试从组件代码中把你正在使用的数据结构隔离出来.这到这一点就要创建一个数据结构,用以表示单个文章:</p>

<p><strong>PATH:</strong>angular/src/app/article/article.model.ts</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">Article</span><span class="p">{</span>
  <span class="nl">title</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="nl">link</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="nl">votes</span><span class="p">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">title</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span><span class="nx">link</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span><span class="nx">votes</span><span class="p">?:</span> <span class="nx">number</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">title</span><span class="o">=</span> <span class="nx">title</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">link</span><span class="o">=</span> <span class="nx">link</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">votes</span><span class="o">=</span> <span class="nx">votes</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<!-- more -->

<p>注意这里创建了一个Article的新类,这是一个普通类而不是Angular组件,在MVC模式中,它被称为模型(model).其中votes参数时可选的(用末尾的?标出来),并且默认为0.</p>

<p><strong>PATH:</strong>angular/src/app/article/article.component.ts</p>
<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">Component</span><span class="p">,</span><span class="nx">OnInit</span><span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">Article</span><span class="p">}</span> <span class="k">from</span> <span class="s1">'./article.model'</span><span class="p">;</span>
<span class="p">...</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">ArticleComponent</span> <span class="kr">implements</span> <span class="nx">OnInit</span><span class="p">{</span>
  <span class="nl">article</span><span class="p">:</span> <span class="nx">Article</span><span class="p">;</span>
  <span class="kd">constructor</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">article</span><span class="o">=</span> <span class="k">new</span> <span class="nx">Article</span><span class="p">(</span>
      <span class="s1">'Angular 2'</span><span class="p">,</span>
      <span class="s1">'http://angular.io'</span><span class="p">,</span>
      <span class="mi">10</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">voteUp</span><span class="p">():</span> <span class="kr">boolean</span><span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">votes</span><span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nx">voteDown</span><span class="p">():</span> <span class="kr">boolean</span><span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">votes</span><span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nx">ngOnInit</span><span class="p">(){}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>这里需要引入Article类,添加代码<code class="highlighter-rouge">import {Article} from './article.model';</code>.</p>

<p>以前将属性存在组件上,现在存储一个对article的引用.接下来还要修改视图代码,从正确的位置获取模板变量.</p>

<p><strong>PATH:</strong>angular/src/app/article/article.component.html</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"four wide column center aligned votes"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"ui statistic"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"value"</span><span class="nt">&gt;</span>
      \{\{article.votes\}\}
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"label"</span><span class="nt">&gt;</span>
      Points
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"twelve wide column"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"ui large header"</span> <span class="na">href=</span><span class="s">"\{\{article.link\}\}"</span><span class="nt">&gt;</span>\{\{article.title\}\}<span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"ui big horizontal list voters"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"item"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;a</span> <span class="na">href</span> <span class="err">(</span><span class="na">click</span><span class="err">)="</span><span class="na">voteUp</span><span class="err">()"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">"arrow up icon"</span><span class="nt">&gt;&lt;/i&gt;</span>
        upvote
      <span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"item"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;a</span> <span class="na">href</span> <span class="err">(</span><span class="na">click</span><span class="err">)="</span><span class="na">voteDown</span><span class="err">()"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">"arrow down icon"</span><span class="nt">&gt;&lt;/i&gt;</span>
        downvote
      <span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<p>这里voteUp和voteDown方法打破了Article类的封装,因为它们直接修改了文章的内部属性.</p>

<table><tr><td bgcolor="#d8ff83">Q: 当前的voteUp和voteDown违反了迪米特法则:</td></tr></table>

<p>A: 迪米特法则值:一个对象对其他对象的结构或属性所作出的假设应该越少越好.</p>

<p><strong>PATH:</strong>angular/src/app/article/article.model.ts</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">Article</span><span class="p">{</span>
  <span class="nl">title</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="nl">link</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="nl">votes</span><span class="p">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">title</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span><span class="nx">link</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span><span class="nx">votes</span><span class="p">?:</span> <span class="nx">number</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">title</span><span class="o">=</span> <span class="nx">title</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">link</span><span class="o">=</span> <span class="nx">link</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">votes</span><span class="o">=</span> <span class="nx">votes</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nx">voteUp</span><span class="p">():</span> <span class="k">void</span><span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">votes</span><span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nx">voteDown</span><span class="p">():</span> <span class="k">void</span><span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">votes</span><span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nx">domain</span><span class="p">():</span> <span class="nx">string</span><span class="p">{</span>
    <span class="k">try</span><span class="p">{</span>
      <span class="kd">const</span> <span class="na">link</span><span class="p">:</span> <span class="nx">string</span><span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">link</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">'//'</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span>
      <span class="k">return</span> <span class="nx">link</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
    <span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>然后在ArticleComponent组件来调用这些方法.</p>

<p><strong>PATH:</strong>angular/src/app/article/article.component.ts</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">ArticleComponent</span> <span class="kr">implements</span> <span class="nx">OnInit</span><span class="p">{</span>
  <span class="nl">article</span><span class="p">:</span> <span class="nx">Article</span><span class="p">;</span>
  <span class="kd">constructor</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">article</span><span class="o">=</span> <span class="k">new</span> <span class="nx">Article</span><span class="p">(</span>
    <span class="s1">'Angular'</span><span class="p">,</span>
    <span class="s1">'http://angular.io'</span><span class="p">,</span>
    <span class="mi">10</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">voteUp</span><span class="p">():</span> <span class="kr">boolean</span><span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">voteUp</span><span class="p">();</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nx">voteDown</span><span class="p">():</span> <span class="kr">boolean</span><span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">voteDown</span><span class="p">();</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nx">ngOnInit</span><span class="p">(){}</span>
<span class="p">}</span>
</code></pre></div></div>

<table><tr><td bgcolor="#d8ff83">Q: 为什么模型和组件都有一个voteUp函数?</td></tr></table>

<p>A: 这两个函数所做的事情略有不同.ArticleComponent上的voteUp()函数是与组件的视图有关,而Article模型上的voteUp()定义了模型上的变化.即将Article模型应该让投票逻辑从特定的视图分离出来,</p>

<h4 id="3-存储多篇文章">3. 存储多篇文章</h4>

<p>展示多个Article的列表先让AppComponent拥有一份文章集合.</p>

<p><strong>PATH:</strong>angular/src/app/app.component.ts</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">Article</span><span class="p">}</span> <span class="k">from</span> <span class="s1">'./article/article.model'</span><span class="p">;</span>
<span class="p">...</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">AppComponent</span><span class="p">{</span>
  <span class="nl">articles</span><span class="p">:</span> <span class="nx">Article</span><span class="p">[];</span>
  <span class="kd">constructor</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">articles</span><span class="o">=</span><span class="p">[</span>
      <span class="k">new</span> <span class="nx">Article</span><span class="p">(</span><span class="s1">'Angular 2'</span><span class="p">,</span><span class="s1">'http://angular.io'</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>
      <span class="k">new</span> <span class="nx">Article</span><span class="p">(</span><span class="s1">'Fullstack'</span><span class="p">,</span><span class="s1">'http://fullstack.io'</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
      <span class="k">new</span> <span class="nx">Article</span><span class="p">(</span><span class="s1">'ReactJs'</span><span class="p">,</span><span class="s1">'http://reactjs.io'</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
    <span class="p">];</span>
  <span class="p">}</span>
  <span class="nx">addArticle</span><span class="p">(</span><span class="nx">title</span><span class="p">:</span> <span class="nx">HTMLInputElement</span><span class="p">,</span><span class="nx">link</span><span class="p">:</span> <span class="nx">HTMLInputElement</span><span class="p">):</span> <span class="kr">boolean</span><span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Adding article title: </span><span class="p">${</span><span class="nx">title</span><span class="p">.</span><span class="nx">value</span><span class="p">}</span><span class="s2"> and link: </span><span class="p">${</span><span class="nx">link</span><span class="p">.</span><span class="nx">value</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
    <span class="nx">title</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
    <span class="nx">link</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<font color="#c42d31">注意:  这里需要引入article模型.</font>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">Article</span><span class="p">}</span> <span class="k">from</span> <span class="s1">'./article/article.model'</span><span class="p">;</span>
</code></pre></div></div>

<p>在angular中<code class="highlighter-rouge">'./filename'</code>表示当前目录,<code class="highlighter-rouge">'../filename'</code>表示上一级目录.</p>

<p><strong>PATH:</strong>angular/src/app/article/article.component.ts</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">OnInit</span> <span class="p">,</span> <span class="nx">Input</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">Article</span><span class="p">}</span> <span class="k">from</span> <span class="s1">'./article.model'</span><span class="p">;</span>
<span class="p">...</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">ArticleComponent</span> <span class="kr">implements</span> <span class="nx">OnInit</span><span class="p">{</span>
  <span class="p">@</span><span class="nd">Input</span><span class="p">()</span> <span class="nx">article</span><span class="p">:</span> <span class="nx">Article</span><span class="p">;</span>
  <span class="nx">voteUp</span><span class="p">():</span> <span class="kr">boolean</span><span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">voteUp</span><span class="p">();</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nx">voteDown</span><span class="p">():</span> <span class="kr">boolean</span><span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">voteDown</span><span class="p">();</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nx">ngOnInit</span><span class="p">(){}</span>
<span class="p">}</span>
</code></pre></div></div>

<font color="#c42d31">注意:  这里使用了@Input,故需要添加Input.</font>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">OnInit</span> <span class="p">,</span> <span class="nx">Input</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="5-渲染文章列表">5. 渲染文章列表</h4>

<p><strong>PATH:</strong>angular/src/app/app.component.html</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...//form
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"ui grid posts"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;app-article</span> <span class="err">*</span><span class="na">ngFor=</span><span class="s">"let article of articles"</span> <span class="err">[</span><span class="na">article</span><span class="err">]="</span><span class="na">article</span><span class="err">"</span><span class="nt">&gt;&lt;/app-article&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<p>要为组件指定一个输入属性article,就要使用<code class="highlighter-rouge">[inputName]="inputValue"</code>表达式.在本例中该表达式的意思是:把输入属性article设置为局部变量article的值,而后者是由ngFor所设置的.</p>

<p>article变量在代码段出现次数太多,可以把NgFor创建的的临时变量命名为footer:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;app-article</span> <span class="err">*</span><span class="na">ngFor=</span><span class="s">"let footer of articles"</span> <span class="err">[</span><span class="na">article</span><span class="err">]="</span><span class="na">footer</span><span class="err">"</span><span class="nt">&gt;&lt;/app-article&gt;</span>
</code></pre></div></div>

<p>这里有三个变量:</p>

<p>(1) articles是一个Article的数组,由AppComponent组件定义;</p>

<p>(2) footer是一个articles数组中的单个元素.由NgFor定义;</p>

<p>(3) article是一个字段名,由ArticleComponent中的inputs属性定义.</p>

<p>本质上,NgFor首先生成了一个临时变量footer,然后把它传给了app-article.</p>

<h4 id="6-添加新文章">6. 添加新文章</h4>

<p><strong>PATH:</strong>angular/src/app/app.component.ts</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">addArticle</span><span class="p">(</span><span class="nx">title</span><span class="p">:</span> <span class="nx">HTMLInputElement</span><span class="p">,</span><span class="nx">link</span><span class="p">:</span> <span class="nx">HTMLInputElement</span><span class="p">):</span> <span class="kr">boolean</span><span class="p">{</span>
  <span class="nx">consle</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Adding article title: </span><span class="p">${</span><span class="nx">title</span><span class="p">.</span><span class="nx">value</span><span class="p">}</span><span class="s2"> and link: </span><span class="p">${</span><span class="nx">link</span><span class="p">.</span><span class="nx">value</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">Article</span><span class="p">(</span><span class="nx">title</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span><span class="nx">link</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
  <span class="nx">title</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
  <span class="nx">link</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="7--最后的修改">7.  最后的修改</h4>

<p>(1) 显示文章所属的域名</p>

<p>为链接添加一个提示信息,以便在用户点击链接时显示将重定向到的域名.</p>

<p>把domain方法添加到Article类中.</p>

<p><strong>PATH:</strong>angular/src/app/article/article.model.ts</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">domain</span><span class="p">():</span> <span class="nx">string</span><span class="p">{</span>
  <span class="k">try</span><span class="p">{</span>
    <span class="kd">const</span> <span class="na">link</span><span class="p">:</span> <span class="nx">string</span><span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">link</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">'//'</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span>
    <span class="k">return</span> <span class="nx">link</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
  <span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>PATH:</strong>angular/src/app/article/article.component.ts</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"twelve wide column"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"ui large header"</span> <span class="na">href=</span><span class="s">"\{\{article.link\}\}"</span><span class="nt">&gt;</span>\{\{article.title\}\}<span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"meta"</span><span class="nt">&gt;</span>
    (\{\{article.domain()\}\})
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"ui big horizontal list voters"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"item"</span><span class="nt">&gt;&lt;a</span> <span class="na">href</span> <span class="err">(</span><span class="na">click</span><span class="err">)="</span><span class="na">voteUp</span><span class="err">()"</span><span class="nt">&gt;&lt;/a&gt;&lt;/li&gt;</span>
    ...
  <span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>
<p>(2) 基于分数重新排序</p>

<p>将分数高的条目显示的顶部.在AppComponent上创建一个新方法sortedArticles.</p>

<p><strong>PATH:</strong>angular/src/app/app.component.ts</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">sortedArticles</span><span class="p">():</span> <span class="nx">Article</span><span class="p">[]{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">articles</span><span class="p">.</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">:</span> <span class="nx">Article</span><span class="p">,</span><span class="nx">b</span><span class="p">:</span> <span class="nx">Article</span><span class="p">)</span><span class="o">=&gt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">votes</span> <span class="o">-</span> <span class="nx">a</span><span class="p">.</span><span class="nx">votes</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>PATH:</strong>angular/src/app/app.component.html</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"ui grid posts"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;app-article</span> <span class="err">*</span><span class="na">ngFor=</span><span class="s">"let article of sortedArticles()"</span> <span class="err">[</span><span class="na">article</span><span class="err">]="</span><span class="na">article</span><span class="err">"</span><span class="nt">&gt;&lt;/app-article&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>
<h4 id="8-总结">8. 总结</h4>

<p>angular程序的写法:</p>

<p>(1) 把应用拆分为组件;</p>

<p>(2) 创建视图;</p>

<p>(3) 定义模型;</p>

<p>(4) 显示模型;</p>

<p>(5) 添加交互.</p>


  </section>
  <footer class="post-footer">
    
<div class="post-f-nav" id="post-nav-id">
  <div class="post-f-nav-next post-f-nav-item">
    
    <a href="/javascript/2017/11/19/javascript-dp-01.html" rel="next" title="JavaScript设计模式--单例模式">
      <i class="fa fa-chevron-left"></i> JavaScript设计模式--单例模式
    </a>
    
  </div>
  <span class="post-nav-divider"></span>
  <div class="post-f-nav-prev post-f-nav-item">
    
    <a href="/angular/2017/11/17/angular-03.html" rel="prev" title="Angular-3-创建应用">
      Angular-3-创建应用
      <i class="fa fa-chevron-right"></i>
    </a>
    
  </div>
</div>

  </footer>
</article>
</section>


    </main>
    <footer id="footer">
  <div class="move-btn">
	<div class="move-con">
		<div class="circleProgress_wrapper">
			<div class="wrapper right">
				<div class="circleProgress rightcircle"></div>
			</div>
			<div class="wrapper left">
				<div class="circleProgress leftcircle"></div>
			</div>
		</div>
		<div class="circle"></div>
		<div class="arrow arrow-hit">
			<i class="fa fa-lg fa-chevron-down"></i>
		</div>
	</div>
</div>
  <div class="contact-list">
    <div class="contact">
      <a target="_blank" href="https://weibo.com/leonmin"><i class="fa fa-weibo"></i></a>
      <a target="_blank" href="https://github.com/leonmin"><i class="fa fa-github"></i></a>
      <a target="_blank" href="https://twitter.com/leonminnn"><i class="fa fa-twitter"></i></a>
      <a target="_blank" href="https://www.instagram.com/leonminnn"><i class="fa fa-instagram"></i></a>
    </div>
    <div class="friend-link">
      <a target="_blank" href="https://jekyllrb.com/"><img src="/assets/images/site/jekyll-logo.png" alt="jekyll"></a>
      <a target="_blank" href="https://leonm.in" title="喵呜~"><img class="friend-link-site" src="/assets/images/site/limi.png" alt="limi"></a>
    </div>
  </div>
</footer>
  </div>
  <script src="/assets/js/jquery.min.js"></script>
  <script src="/assets/js/simple-jekyll-search.js"></script>
  <script src="/assets/js/limon.js"></script>
</body>
</html>